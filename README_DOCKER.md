#!/usr/bin/env bash

# QD-SAM Docker å¿«é€Ÿéƒ¨ç½²æŒ‡å—
# ç”¨äºåœ¨æœåŠ¡å™¨ä¸Šå¿«é€Ÿéƒ¨ç½²å’Œè¿è¡Œ QD-SAM åº”ç”¨

cat << 'EOF'
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                   ğŸ³ QD-SAM Docker å¿«é€Ÿéƒ¨ç½²æŒ‡å—                             â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“¦ é¡¹ç›®ä½ç½®
  /Users/yuzhuolin/Desktop/å‰ç«¯/12_7

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸš€ ä¸‰ç§éƒ¨ç½²æ–¹å¼

1ï¸âƒ£  æœ¬åœ° Docker æµ‹è¯• (æ¨èå…ˆæµ‹è¯•)
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   cd /Users/yuzhuolin/Desktop/å‰ç«¯/12_7
   docker-compose up -d
   
   è®¿é—®: http://localhost
   âœ… å®Œå…¨æœ¬åœ°è¿è¡Œï¼Œä¸éœ€è¦æœåŠ¡å™¨

2ï¸âƒ£  ä¸€é”®è‡ªåŠ¨éƒ¨ç½²åˆ°æœåŠ¡å™¨ (æ¨èç®€ä¾¿)
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   ./deploy-server.sh ubuntu 192.168.1.100 /opt/qd-sam
   
   è‡ªåŠ¨åŒ–æ­¥éª¤:
   âœ“ SSH è¿æ¥éªŒè¯
   âœ“ è¿œç¨‹ç›®å½•åˆ›å»º
   âœ“ æ–‡ä»¶ä¸Šä¼  (rsync)
   âœ“ Docker é•œåƒæ„å»º
   âœ“ å®¹å™¨å¯åŠ¨

3ï¸âƒ£  æ‰‹åŠ¨éƒ¨ç½²åˆ°æœåŠ¡å™¨ (æ¨èç†è§£ç»†èŠ‚)
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   # ä¸Šä¼ æ–‡ä»¶
   scp -r /Users/yuzhuolin/Desktop/å‰ç«¯/12_7 \
       user@server:/opt/qd-sam
   
   # SSH è¿æ¥
   ssh user@server
   cd /opt/qd-sam
   
   # æ„å»ºå¹¶å¯åŠ¨
   docker-compose up -d
   
   # æŸ¥çœ‹çŠ¶æ€
   docker ps
   curl http://localhost/health

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“‹ å·²åˆ›å»ºçš„ Docker é…ç½®æ–‡ä»¶

æ ¸å¿ƒæ–‡ä»¶:
  âœ… Dockerfile              - å¤šé˜¶æ®µé•œåƒæ„å»ºå®šä¹‰
  âœ… docker-compose.yml      - Docker Compose ç¼–æ’
  âœ… docker-entrypoint.sh    - å®¹å™¨å¯åŠ¨è„šæœ¬
  âœ… nginx.conf              - Nginx åå‘ä»£ç†é…ç½®
  âœ… .dockerignore           - æ„å»ºå¿½ç•¥æ–‡ä»¶åˆ—è¡¨

è„šæœ¬å·¥å…·:
  âœ… build-docker.sh         - æœ¬åœ°æ„å»ºè„šæœ¬ (äº¤äº’å¼)
  âœ… deploy-server.sh        - æœåŠ¡å™¨éƒ¨ç½²è„šæœ¬ (å…¨è‡ªåŠ¨)

æ–‡æ¡£:
  âœ… DOCKER_QUICK_START.md          - å¿«é€Ÿå‚è€ƒå¡
  âœ… DOCKER_GUIDE.md                - è¯¦ç»†éƒ¨ç½²æŒ‡å—
  âœ… DOCKER_DEPLOYMENT_SUMMARY.md   - å®Œæˆæ€»ç»“

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ¯ ä½¿ç”¨ç¤ºä¾‹

ç¤ºä¾‹ 1: æœ¬åœ°æµ‹è¯• (æœ€ç®€å•)
  cd /Users/yuzhuolin/Desktop/å‰ç«¯/12_7
  docker-compose up -d
  # æ‰“å¼€ http://localhost

ç¤ºä¾‹ 2: è‡ªåŠ¨éƒ¨ç½²åˆ°æœåŠ¡å™¨ (Linux)
  ./deploy-server.sh ubuntu 192.168.1.100 /opt/qd-sam
  # å®Œå…¨è‡ªåŠ¨åŒ–ï¼ŒåŒ…æ‹¬ SSHã€ä¸Šä¼ ã€æ„å»ºã€å¯åŠ¨

ç¤ºä¾‹ 3: è‡ªåŠ¨éƒ¨ç½²åˆ°æœåŠ¡å™¨ (macOS/SSH å¯†é’¥)
  ./deploy-server.sh \
    ubuntu \
    qd-sam.example.com \
    /home/ubuntu/qd-sam
  # æ— éœ€è¾“å…¥å¯†ç ï¼ˆéœ€è¦ SSH å¯†é’¥é…ç½®ï¼‰

ç¤ºä¾‹ 4: æ‰‹åŠ¨éƒ¨ç½² (å­¦ä¹ è¿‡ç¨‹)
  # ç¬¬1æ­¥: ä¸Šä¼ 
  scp -r /Users/yuzhuolin/Desktop/å‰ç«¯/12_7 \
      root@192.168.1.100:/opt/
  
  # ç¬¬2æ­¥: è¿œç¨‹è¿æ¥
  ssh root@192.168.1.100
  
  # ç¬¬3æ­¥: æ„å»ºå’Œå¯åŠ¨
  cd /opt/12_7
  docker-compose up -d

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ” éªŒè¯éƒ¨ç½²æˆåŠŸ

âœ“ æ£€æŸ¥å®¹å™¨è¿è¡ŒçŠ¶æ€
  docker ps | grep qd-sam

âœ“ æµ‹è¯•å¥åº·æ£€æŸ¥
  curl http://localhost/health
  # åº”è¿”å› {"status": "ok"}

âœ“ æŸ¥çœ‹å®æ—¶æ—¥å¿—
  docker-compose logs -f

âœ“ æ‰“å¼€å‰ç«¯åº”ç”¨
  http://localhost (æœ¬åœ°)
  http://server_ip (æœåŠ¡å™¨)

âœ“ æµ‹è¯• API ä¸Šä¼ 
  curl -X POST -F "file=@image.jpg" \
    http://localhost/upload-test

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ› ï¸  å¸¸ç”¨ Docker Compose å‘½ä»¤

å¯åŠ¨æœåŠ¡          docker-compose up -d
æŸ¥çœ‹æ—¥å¿—          docker-compose logs -f
åœæ­¢æœåŠ¡          docker-compose down
é‡å¯æœåŠ¡          docker-compose restart
é‡æ–°æ„å»º          docker-compose up -d --build
æŸ¥çœ‹çŠ¶æ€          docker-compose ps
æ¸…ç†èµ„æº          docker-compose down -v

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âš™ï¸  é•œåƒä¿¡æ¯

åŸºç¡€é•œåƒ:  python:3.10-slim + nginx
å¤§å°:      ~2.2GB (åŒ…å« SAM2 æ¨¡å‹)
å‰ç«¯:      Vue 3 + Vite (é™æ€æ„å»º)
åç«¯:      Flask Python åº”ç”¨
æ¨¡å‹:      SAM2 (åœ¨ /app/QD ç›®å½•)

æš´éœ²ç«¯å£:
  80    - Nginx å‰ç«¯
  5001  - Flask åç«¯ API

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“Š éƒ¨ç½²æ­¥éª¤è€—æ—¶ä¼°è®¡

æœ¬åœ°æ„å»º:        5-15 åˆ†é’Ÿ
æœåŠ¡å™¨æ„å»º:      10-20 åˆ†é’Ÿ (å–å†³äºç½‘ç»œ)
æ–‡ä»¶ä¸Šä¼ :        5-15 åˆ†é’Ÿ (å–å†³äºç½‘ç»œ)
å®¹å™¨å¯åŠ¨:        1-3 åˆ†é’Ÿ
æ¨¡å‹é¦–æ¬¡åŠ è½½:    2-5 åˆ†é’Ÿ (åœ¨çº¿æœç´¢)

æ€»è®¡ (è‡ªåŠ¨éƒ¨ç½²): 20-45 åˆ†é’Ÿ

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

â“ å¸¸è§é—®é¢˜

Q: é•œåƒæ„å»ºå¤±è´¥?
A: æ£€æŸ¥ Docker ç‰ˆæœ¬ (20.10+) å’Œç£ç›˜ç©ºé—´ (20GB+)
   æŸ¥çœ‹è¯¦ç»†æ—¥å¿—: docker build --no-cache -t qd-sam:latest .

Q: å®¹å™¨æ— æ³•å¯åŠ¨?
A: æŸ¥çœ‹æ—¥å¿—: docker-compose logs
   æ£€æŸ¥æ¨¡å‹æ–‡ä»¶: docker exec qd-sam-app ls -la /app/QD/

Q: æ¨¡å‹æ¨ç†å¾ˆæ…¢?
A: è¿™æ˜¯æ­£å¸¸çš„ (CPU ä¸Šéœ€è¦ 1-5 åˆ†é’Ÿ)
   æŸ¥çœ‹è¿›åº¦: docker logs -f qd-sam-app

Q: å¦‚ä½•æ›´æ–°ä»£ç ?
A: docker-compose down && docker-compose up -d --build

Q: å¦‚ä½•å¤‡ä»½æ•°æ®?
A: docker cp qd-sam-app:/app/backend/uploads ./backup/

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“š è¯¦ç»†æ–‡æ¡£

å¿«é€Ÿå‚è€ƒ:    cat DOCKER_QUICK_START.md
å®Œæ•´æŒ‡å—:    cat DOCKER_GUIDE.md
éƒ¨ç½²æ€»ç»“:    cat DOCKER_DEPLOYMENT_SUMMARY.md

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âœ… å®Œæˆ! Docker é…ç½®å·²å°±ç»ª

æ‰€æœ‰æ–‡ä»¶å·²ä¿å­˜åˆ° GitHub: https://github.com/LawrenceBelle4/AI4QD

ä¸‹ä¸€æ­¥:
  1. æœ¬åœ°æµ‹è¯•: docker-compose up -d
  2. æœåŠ¡å™¨éƒ¨ç½²: ./deploy-server.sh
  3. ç›‘æ§æ—¥å¿—: docker-compose logs -f
  4. ç”Ÿäº§ç»´æŠ¤: å‚è€ƒ DOCKER_GUIDE.md

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  ğŸ‰ å‡†å¤‡å°±ç»ª! æ‚¨å¯ä»¥å¼€å§‹ä½¿ç”¨ Docker éƒ¨ç½² QD-SAM åº”ç”¨äº†                     â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

EOF
